//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_g "errors";_d "fmt";_c "github.com/unidoc/unipdf/v3/common";_b "github.com/unidoc/unipdf/v3/core";);func (_egf *Document )FindCatalog ()(*Catalog ,bool ){var _dd *_b .PdfObjectDictionary ;for _ ,_bcb :=range _egf .Objects {_bfa ,_dbe :=_b .GetDict (_bcb );
if !_dbe {continue ;};if _bcd ,_eaa :=_b .GetName (_bfa .Get ("\u0054\u0079\u0070\u0065"));_eaa &&*_bcd =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_dd =_bfa ;break ;};};if _dd ==nil {return nil ,false ;};return &Catalog {Object :_dd ,_a :_egf },true ;};
func (_bae Page )GetResourcesXObject ()(*_b .PdfObjectDictionary ,bool ){_gga ,_aa :=_bae .GetResources ();if !_aa {return nil ,false ;};return _b .GetDict (_gga .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};type Page struct{_aff int ;Object *_b .PdfObjectDictionary ;
_bba *Document ;};type Document struct{ID [2]string ;Version _b .Version ;Objects []_b .PdfObject ;Info _b .PdfObject ;Crypt *_b .PdfCrypt ;UseHashBasedID bool ;};func (_af *Catalog )GetPages ()([]Page ,bool ){_ec ,_eb :=_b .GetDict (_af .Object .Get ("\u0050\u0061\u0067e\u0073"));
if !_eb {return nil ,false ;};_ebe ,_db :=_b .GetArray (_ec .Get ("\u004b\u0069\u0064\u0073"));if !_db {return nil ,false ;};_gf :=make ([]Page ,_ebe .Len ());for _bc ,_ba :=range _ebe .Elements (){_cc ,_ae :=_b .GetDict (_ba );if !_ae {continue ;};_gf [_bc ]=Page {Object :_cc ,_aff :_bc +1,_bba :_af ._a };
};return _gf ,true ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _b .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_b .PdfObjectStream ;};func (_bf *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_df :=_bf .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _df ==nil {return nil ,false ;};_ee ,_dg :=_b .GetIndirect (_df );if !_dg {return nil ,false ;};_ef ,_ed :=_b .GetArray (_ee .PdfObject );if !_ed {return nil ,false ;};return &OutputIntents {_gaba :_ee ,_fa :_ef ,_faa :_bf ._a },true ;};func (_dgb *Document )AddIndirectObject (indirect *_b .PdfIndirectObject ){for _ ,_gb :=range _dgb .Objects {if _gb ==indirect {return ;
};};_dgb .Objects =append (_dgb .Objects ,indirect );};type OutputIntents struct{_fa *_b .PdfObjectArray ;_faa *Document ;_gaba *_b .PdfIndirectObject ;};func (_bff Page )FindXObjectForms ()[]*_b .PdfObjectStream {_fcb ,_dae :=_bff .GetResourcesXObject ();
if !_dae {return nil ;};_agdb :=map[*_b .PdfObjectStream ]struct{}{};var _eee func (_eccf *_b .PdfObjectDictionary ,_eccfe map[*_b .PdfObjectStream ]struct{});_eee =func (_bdef *_b .PdfObjectDictionary ,_gdg map[*_b .PdfObjectStream ]struct{}){for _ ,_fab :=range _bdef .Keys (){_dec ,_gcb :=_b .GetStream (_bdef .Get (_fab ));
if !_gcb {continue ;};if _ ,_bdc :=_gdg [_dec ];_bdc {continue ;};_bbe ,_fbf :=_b .GetName (_dec .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_fbf ||_bbe .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_gdg [_dec ]=struct{}{};_egd ,_fbf :=_b .GetDict (_dec .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
if !_fbf {continue ;};_gff ,_aag :=_b .GetDict (_egd .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));if _aag {_eee (_gff ,_gdg );};};};_eee (_fcb ,_agdb );var _bee []*_b .PdfObjectStream ;for _gde :=range _agdb {_bee =append (_bee ,_gde );};return _bee ;
};func (_dbf *Document )AddStream (stream *_b .PdfObjectStream ){for _ ,_bec :=range _dbf .Objects {if _bec ==stream {return ;};};_dbf .Objects =append (_dbf .Objects ,stream );};type OutputIntent struct{Object *_b .PdfObjectDictionary ;};func (_fc *OutputIntents )Get (i int )(OutputIntent ,bool ){if _fc ._fa ==nil {return OutputIntent {},false ;
};if i >=_fc ._fa .Len (){return OutputIntent {},false ;};_dca :=_fc ._fa .Get (i );_cea ,_ca :=_b .GetIndirect (_dca );if !_ca {_afc ,_egb :=_b .GetDict (_dca );return OutputIntent {Object :_afc },_egb ;};_cg ,_ccf :=_b .GetDict (_cea .PdfObject );return OutputIntent {Object :_cg },_ccf ;
};func (_eaed *Content )SetData (data []byte )error {_bed ,_fdb :=_b .MakeStream (data ,_b .NewFlateEncoder ());if _fdb !=nil {return _fdb ;};_acf ,_eaedf :=_b .GetArray (_eaed ._efg .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_eaedf &&_eaed ._cbdf ==0{_eaed ._efg .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_bed );
}else {if _fdb =_acf .Set (_eaed ._cbdf ,_bed );_fdb !=nil {return _fdb ;};};_eaed ._efg ._bba .Objects =append (_eaed ._efg ._bba .Objects ,_bed );return nil ;};type ImageSMask struct{Image *Image ;Stream *_b .PdfObjectStream ;};func (_eeb Page )GetResources ()(*_b .PdfObjectDictionary ,bool ){return _b .GetDict (_eeb .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};type Catalog struct{Object *_b .PdfObjectDictionary ;_a *Document ;};func (_bab *Document )GetPages ()([]Page ,bool ){_afb ,_bfg :=_bab .FindCatalog ();if !_bfg {return nil ,false ;};return _afb .GetPages ();};type Content struct{Stream *_b .PdfObjectStream ;
_cbdf int ;_efg Page ;};func (_aeg *Catalog )SetMetadata (data []byte )error {_fd ,_ag :=_b .MakeStream (data ,nil );if _ag !=nil {return _ag ;};_fd .Set ("\u0054\u0079\u0070\u0065",_b .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_fd .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_b .MakeName ("\u0058\u004d\u004c"));
_aeg .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_fd );_aeg ._a .Objects =append (_aeg ._a .Objects ,_fd );return nil ;};func (_dcc Page )GetContents ()([]Content ,bool ){_bca ,_eed :=_b .GetArray (_dcc .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_eed {_aed ,_agd :=_b .GetStream (_dcc .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_agd {return nil ,false ;};return []Content {{Stream :_aed ,_efg :_dcc ,_cbdf :0}},true ;};_baec :=make ([]Content ,_bca .Len ());for _baa ,_bce :=range _bca .Elements (){_gc ,_aegg :=_b .GetStream (_bce );
if !_aegg {continue ;};_baec [_baa ]=Content {Stream :_gc ,_efg :_dcc ,_cbdf :_baa };};return _baec ,true ;};func (_dc *Catalog )GetMarkInfo ()(*_b .PdfObjectDictionary ,bool ){_ab ,_gd :=_b .GetDict (_dc .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _ab ,_gd ;};func (_ade *Page )Number ()int {return _ade ._aff };func (_gab *Catalog )SetMarkInfo (mi _b .PdfObject ){_fg :=_b .MakeIndirectObject (mi );_gab .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_fg );_gab ._a .Objects =append (_gab ._a .Objects ,_fg );
};func (_bfgc Page )FindXObjectImages ()([]*Image ,error ){_efe ,_def :=_bfgc .GetResourcesXObject ();if !_def {return nil ,nil ;};var _fef []*Image ;var _afbb error ;_ega :=map[*_b .PdfObjectStream ]int {};_bda :=map[*_b .PdfObjectStream ]struct{}{};var _bde int ;
for _ ,_fag :=range _efe .Keys (){_ggg ,_ecd :=_b .GetStream (_efe .Get (_fag ));if !_ecd {continue ;};if _ ,_affa :=_ega [_ggg ];_affa {continue ;};_dfca ,_bbf :=_b .GetName (_ggg .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_bbf ||_dfca .String ()!="\u0049\u006d\u0061g\u0065"{continue ;
};_geg :=Image {BitsPerComponent :8,Stream :_ggg ,Name :string (_fag )};if _geg .Colorspace ,_afbb =_gaf (_ggg .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_afbb !=nil {_c .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_afbb );
continue ;};if _feb ,_ddd :=_b .GetIntVal (_ggg .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_ddd {_geg .BitsPerComponent =_feb ;};if _da ,_ffc :=_b .GetIntVal (_ggg .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_ffc {_geg .Width =_da ;};if _baaf ,_dbd :=_b .GetIntVal (_ggg .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_dbd {_geg .Height =_baaf ;};if _fed ,_ead :=_b .GetStream (_ggg .Get ("\u0053\u004d\u0061s\u006b"));_ead {_geg .SMask =&ImageSMask {Image :&_geg ,Stream :_fed };
_bda [_fed ]=struct{}{};};switch _geg .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_geg .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_geg .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_geg .ColorComponents =4;
default:_geg .ColorComponents =-1;};_ega [_ggg ]=_bde ;_fef =append (_fef ,&_geg );_bde ++;};var _cdb []int ;for _ ,_bag :=range _fef {if _bag .SMask !=nil {_eedc ,_fce :=_ega [_bag .SMask .Stream ];if _fce {_cdb =append (_cdb ,_eedc );};};};_ggb :=make ([]*Image ,len (_fef )-len (_cdb ));
_bde =0;_fda :for _gca ,_aae :=range _fef {for _ ,_afd :=range _cdb {if _gca ==_afd {continue _fda ;};};_ggb [_bde ]=_aae ;_bde ++;};return _fef ,nil ;};func (_eca *OutputIntents )Len ()int {return _eca ._fa .Len ()};func _gaf (_cd _b .PdfObject )(_b .PdfObjectName ,error ){var _dfc *_b .PdfObjectName ;
var _bge *_b .PdfObjectArray ;if _ecc ,_acc :=_cd .(*_b .PdfIndirectObject );_acc {if _agb ,_ad :=_ecc .PdfObject .(*_b .PdfObjectArray );_ad {_bge =_agb ;}else if _cbd ,_dcab :=_ecc .PdfObject .(*_b .PdfObjectName );_dcab {_dfc =_cbd ;};}else if _fac ,_ffb :=_cd .(*_b .PdfObjectArray );
_ffb {_bge =_fac ;}else if _eccd ,_bgg :=_cd .(*_b .PdfObjectName );_bgg {_dfc =_eccd ;};if _dfc !=nil {switch *_dfc {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_dfc ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_dfc ,nil ;};};if _bge !=nil &&_bge .Len ()> 0{if _bga ,_ggd :=_bge .Get (0).(*_b .PdfObjectName );_ggd {switch *_bga {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _bge .Len ()==1{return *_bga ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_bga ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_bga ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_bga ,nil ;};};};return "",nil ;};func (_fba Content )GetData ()([]byte ,error ){_dcce ,_gcbb :=_b .NewEncoderFromStream (_fba .Stream );
if _gcbb !=nil {return nil ,_gcbb ;};_bef ,_gcbb :=_dcce .DecodeStream (_fba .Stream );if _gcbb !=nil {return nil ,_gcbb ;};return _bef ,nil ;};func (_f *Catalog )GetMetadata ()(*_b .PdfObjectStream ,bool ){_ff ,_ga :=_b .GetStream (_f .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
return _ff ,_ga ;};func (_bg *Catalog )SetVersion (){_bg .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_b .MakeName (_d .Sprintf ("\u0025\u0064\u002e%\u0064",_bg ._a .Version .Major ,_bg ._a .Version .Minor )));};func (_ce *Catalog )HasMetadata ()bool {_gfc :=_ce .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _gfc !=nil ;};func (_bd *OutputIntents )Add (oi _b .PdfObject )error {_eg ,_eac :=oi .(*_b .PdfObjectDictionary );if !_eac {return _g .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _gdd ,_eae :=_b .GetStream (_eg .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_eae {_bd ._faa .Objects =append (_bd ._faa .Objects ,_gdd );};_fgf ,_bb :=oi .(*_b .PdfIndirectObject );if !_bb {_fgf =_b .MakeIndirectObject (oi );
};if _bd ._fa ==nil {_bd ._fa =_b .MakeArray (_fgf );}else {_bd ._fa .Append (_fgf );};_bd ._faa .Objects =append (_bd ._faa .Objects ,_fgf );return nil ;};func (_ea *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _ac :=_ea .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_ac !=nil {for _fdf ,_be :=range _ea ._a .Objects {if _be ==_ac {if outputIntents ._gaba ==_ac {return ;};_ea ._a .Objects =append (_ea ._a .Objects [:_fdf ],_ea ._a .Objects [_fdf +1:]...);break ;};};};_gg :=outputIntents ._gaba ;if _gg ==nil {_gg =_b .MakeIndirectObject (outputIntents ._fa );
};_ea .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_gg );_ea ._a .Objects =append (_ea ._a .Objects ,_gg );};func (_fe *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_faa :_fe ._a }};
